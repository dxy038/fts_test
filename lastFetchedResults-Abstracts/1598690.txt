In this paper we present a complex hybrid model in the water management field based on a synergetic combination of deterministic and machine learning model components. The objective of a Water Supply System (WSS) is to convey treated water to consumers through a pressurized network of pipes. A number of meters and gauges are used to take continuous or periodic measurements that are sent via a telemetry system to the control and operation center and used to monitor the network. Using this typically limited number of measures together with demand predictions the state of the system must be assessed. Suitable state estimation is of paramount importance in diagnosing leaks and other faults and anomalies in WSS. But this task can be really cumbersome, if not unachievable, for human operators. The aim of this paper is to explore the possibility for a technique borrowed from machine learning, specifically a neuro-fuzzy approach, to perform such a task. For one thing, state estimation of a network is performed by using optimization techniques that minimize the discrepancies between the measures taken by telemetry and the values produced by the mathematical model of the network, which tries to reconcile all the available information. But, for another, although the model can be completely accurate, the estimation is based on data containing non-negligible levels of uncertainty, which definitely influences the precision of the estimated states. The quantification of the uncertainty of the input data (telemetry measures and demand predictions) can be achieved by means of robust estate estimation. By making use of the mathematical model of the network, estimated states together with uncertainty levels, that is to say, fuzzy estimated states, for different anomalous states of the network can be obtained. These two steps rely on a theory-driven model. The final aim is to train a neural network (using the fuzzy estimated states together with a description of the associated anomaly) capable of assessing WSS anomalies associated with particular sets of measurements received by telemetry and demand predictions. This is the data-driven counterpart of the hybrid model.
