Depleting fossil fuels and ever-increasing environmental have attracted much attention to the renewable energy resources. The Micro-Grid (MG) concept is an appropriate means for increasing the adaptation of these resources with current power system architecture. In this paper a new method is used to solve the problem of unit sizing in a grid-connected MG providing electrical and thermal loads simultaneously. Our main goal is to reduce the fossil fuels dependency of the MG which includes a photovoltaic (PV)/ wind hybrid system with storage energy system including electrolyzer, hydrogen tank, CHP based fuel cell, heater and boiler. The heater is used as the provider of part of the thermal load when the generated power is more than the load and the capacity of the storage system is not adequate, and the boiler is used as backup unit for supplying thermal load. Due to high importance of the pollution problems, this subject is considered in objective function as cost term. Reliability index is used as limitative subject and interruption cost considered in the objective function. IEEE load data and real case study in Ardabil region for wind speed and solar radiation has been used. Modified Particles Swarm Optimization (MPSO) Algorithm is used to obtain global optimal solution. 
