Among those currently proposed in the technical literature, most Energy Management Systems (EMSs) that are based on the formulation and solution of an optimization problem, can be classified in two categories: some of them solve the problem using Dynamic Programming (DP), which is quite computationally expensive in terms of memory occupation; others, in order to solve the problem using Linear Programming (LP) that has a lower computational cost, introduce a simplification, i.e., they consider positive and negative power flows at bidirectional devices separately, instead of considering the net exchanged power. Furthermore, each currently available EMS is only able to achieve one goal at a time, providing advantages either for the end-user or for the grid manager/administrator. Starting from the above considerations, a novel EMS for residential microgrids is proposed in this paper. It exploits the forecasting of PV generation and load demand profiles by means of suitably chosen and trained neural networks. Furthermore, it is based on solving two different optimization problems during two stages of the algorithm, aiming at reconciling end-user and utility needs. Thanks to a suitable mathematical formulation, it manages to solve the optimization problems using Mixed Integer Linear Programming (MILP), instead of DP. A series of simulations is performed to validate the proposed EMS, whose results are presented and discussed.
