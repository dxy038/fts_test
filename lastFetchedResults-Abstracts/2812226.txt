In this paper, a novel intelligent controller for grid connection of DC microgrids is presented. The proposed controller allows the bi-directional AC/DC converter, linking the DC microgrid to the main utility grid, to provide the main functionalities of an inverter. Such functions include bi-directional power flow control and independent control of both active power (P) and reactive power (Q). In addition, the developed controller acts as an intelligent active power filter (APF) to the main grid. This is because it autonomously detects any power quality problems, filters out load-created harmonics and compensates unbalances and/or DC offsets resulting from the local AC load connected at the point of common coupling (PCC). The objective of the controller is to force the AC grid currents at the PCC to be balanced three-phase currents with minor harmonics while maintaining its controllability of power flow regardless of the characteristics of the local AC load. The performance of the developed controller was examined under several extreme cases including: non-linear loads, distorted load currents, unbalanced and offset conditions. The results show that the developed controller succeeds to maintain bi-directional P/Q flow controllability, allows the inverter to provide ancillary services such as reactive power compensation or voltage control to the grid while simultaneously acting as an active power filter to assure improved power quality at the PCC under various loading conditions.
