A multiscale adjoint (MSADJ) method is developed to compute high-resolution sensitivity coefficients for subsurface flow in large-scale heterogeneous geologic formations. In this method, the original fine-scale problem is partitioned into a set of coupled subgrid problems, such that the global adjoint problem can be efficiently solved on a coarse grid. Then, the coarse-scale sensitivities are interpolated to the local fine grid by reconstructing the local variability of the model parameters with the aid of solving embedded adjoint subproblems. The approach employs the multiscale finite-volume (MSFV) formulation to accurately and efficiently solve the highly detailed flow problem. The MSFV method couples a global coarse-scale solution with local fine-scale reconstruction operators, hence yielding model responses that are quite accurate at both scales. The MSADJ method is equally efficient in computing the gradient of the objective function with respect to model parameters. Several examples demonstrate that the approach is accurate and computationally efficient. The accuracy of our multiscale method for inverse problems is twofold: the sensitivity coefficients computed by this approach are more accurate than the traditional finite-difference-based numerical method for computing derivatives, and the calibrated models after history matching honor the available dynamic data on the fine scale. In other words, the multiscale based adjoint scheme can be used to history match fine-scale models quite effectively.
