When a single stock is modeled by switching geometric Brownian motion, optimal security investment problem with the objective of maximizing the long-run growth rate of after-tax wealth is established. This problem has been transformed into an optimal stopping problem. By solving the generational Stefan problem, the optimal trading strategy is obtained. Numerical example indicates that it is optimal not only to cut short the losses, but also the profits. Tax does not mean bad things for investors and they can get better performance by making use of the tax credit.
