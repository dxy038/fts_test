In this article, we present a three dimensional object profile measurement system based on the depth of focus principle. The sharpness of an image depends on the focusing accuracy of the lens. This principle is utilized to find the profile of a test specimen. For a microscope with a fixed-focal length objective lens, the acquired image will reach the maximum sharpness when the relative distance between the lens and the surface point is equal to the focal length of the lens. The sharpness of an image is defined to be the sum of absolute difference of the gray scale level within the interested area. The optical profile measurement system finds the best focused position for many evenly spaced square patches in the image by moving the lens along the optical axis and acquiring image at constant intervals. In theory, the relation between the sharpness value and the relative objective distance exhibits a Gaussian function distribution. However, sharp edges, poor illumination and many other factors will deviate the distribution profile from the ideal one, and give erroneous profile information. To improve the accuracy of the profile measurement system, we propose a focus position screening algorithm which can judge the quality of the focusing information based on the sharpness function distribution. This algorithm can remove unreliable measurement points resulted from out-of-focus background, and sharp edges. These algorithms are implemented in a prototype system to measure the profile of a EIA-0603-size ceramic capacitor with a dimension less than 1 mm. The profile of the capacitor is accurately measurement to the accuracy of the objective lensÂ´ depth of field.
