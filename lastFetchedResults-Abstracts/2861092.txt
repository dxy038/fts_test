We present a novel hybrid nonlinear Model Predictive Control (MPC) algorithm for real-time control of hydraulic structures in water systems. These systems can be regarded as hybrid systems because they involve both continuous and discrete elements. The algorithm uses Time Instant Optimization for the control of discrete variables. The presented method introduces a procedure to obtain continuous time instants, allowing the derivation of a gradient of the objective function. Reverse-mode algorithmic differentiation is applied to obtain the analytical gradient of the objective function. The gradient allows the use of efficient gradient-based optimizers, making the approach suitable for real-time control applications. Furthermore, hybrid schemes including the optimization of time instants and standard MPC can be easily integrated. We illustrate an application of the algorithm to the control of five hydraulic structures in the Fivelingo water system, a water system consisting of discrete and continuous variables that is located in the North-East of Netherlands.
