An adjoint sensitivity method based on the shallow-water equations is developed for water wave control in river and estuarine systems. The method is used to compute the gradient of a user-defined objective function in the N-dimensional parameter space consisting of system control settings with just one solution of the basic problem and one solution of the associated adjoint problem. Characteristic equations are derived for the adjoint problem and a new formalism is proposed for the sensitivity of shallow-water flow to boundary changes in depth and discharge. New adjoint boundary conditions are developed for river and estuarine forecasting models with open-water inflow and outflow sections. This gives rise to new expressions for sensitivities at these sections. Characteristic analysis of the adjoint and basic problems shows that sensitivities propagate in the reverse time direction along the characteristic paths of the basic problem. The Riemann variables of the adjoint problem are shown to precisely describe the sensitivity of the objective function to changes in depth and discharge at system boundaries. The method is extended to two space dimensions by bicharacteristic analysis.
