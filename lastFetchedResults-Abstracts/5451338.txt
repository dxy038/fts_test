Heartbeat mechanism is widely used in designing high availability distributed system. In this paper, we design a multi-level heartbeat protocol, which consists of two kinds of heartbeat protocols: multipoint heartbeat protocol and bidirectional heartbeat protocol. Multi-level heartbeat protocol is very convenient for the nodes to join and leave the heartbeat protocol and can also avoid the single point of failure which will cause fatal fault to the system. We then implement a high availability distributed system based on multi-level heartbeat protocol and at the same time adopt fish effect and task redistribute mechanism to avoid the single point of failure. All of these can acquire high availability.
