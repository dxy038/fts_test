This paper develops an effective and, yet, practical solution methodology for optimal capacitor placement, replacement and control in large-scale unbalanced, general radial or loop distribution systems. The solution methodology can optimally determine (i) the locations to install (or replace, or remove) capacitors, (ii) the types and sizes of capacitors to be installed (or replaced) and, during each load level, (iii) the control schemes for each capacitor in the nodes of a general three-phase unbalanced distribution system such that a desired objective function is minimized while the load constraints, network constraints and operational constraints at different load levels are satisfied. The solution methodology is based on a combination of the simulated annealing technique and the greedy search technique in order to achieve computational speed and high-quality solutions. Both the numerical and implementational aspects of the solution methodology are detailed. Analysis of the computational complexity of the solution algorithm indicates that the algorithm is also effective for large-scale distribution systems in terms of computational efforts. Test, results on a realistic, unbalanced distribution network, a 291-bus with 77 laterals, 305 distribution lines and 6 transformers with varying loading conditions, are presented with promising results. The robustness of the solution methodology under varying loading conditions is also investigated
