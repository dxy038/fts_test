We develop on-line routing and wavelength assignment (RWA) algorithms for WDM bidirectional ring and torus networks with N nodes. The algorithms dynamically support all k-allowable traffic matrices, where k denotes an arbitrary integer vector [k<sub>1</sub>, k<sub>2</sub>,... k<sub>N</sub>], and node i, 1 &#8804; i &#8804; N, can transmit at most k<sub>i</sub> wavelengths and receive at most k<sub>i</sub> wavelengths. Both algorithms support the changing traffic in a rearrangeably nonblocking fashion. Our first algorithm, for a bidirectional ring, uses [(&#931;<sub>i=1</sub><sup>N</sup> k<sub>i</sub>)/3] wavelengths in each fiber and requires at most three lightpath rearrangements per new session request regardless of the number of nodes N and the amount of traffic k. When all the k<sub>i</sub>´s are equal to k, the algorithm uses [kN/3] wavelengths, which is known to be the minimum for any off-line rearrangeably nonblocking algorithm. Our second algorithm, for a torus topology, is an extension of a known off-line algorithm for the special case with all the k<sub>i</sub>´s equal to k. For an R &#215; C torus network with R &#8805; C nodes, our on-line algorithm uses [kR/2] wavelengths in each fiber, which is the same as in the off-line algorithm, and is at most two times a lower bound obtained by assuming full wavelength conversion at all nodes. In addition, the on-line algorithm requires at most C - 1 lightpath rearrangements per new session request regardless of the amount of traffic k. Finally, each RWA update requires solving a bipartite matching problem whose time complexity is only O (R), which is much smaller than the time complexity O(kCR<sup>2</sup>) of the bipartite matching problem for an off-line algorithm.
