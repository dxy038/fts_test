In this paper, we present a unifying optimization framework for greening geographically distributed Data Centers (DCs) by means of three control operations: (1) inter-DC request routing at front-end proxies, (2) intra-DC request routing at tiered core switches and edge switches, and (3) Virtual Machine (VM) scheduling on heterogeneous physical servers. We first formulate the request routing and VM scheduling problem as a stochastic program which aims to minimize the time average electricity cost, carbon taxes and bandwidth cost for Cloud Service Providers (CSPs) while guaranteeing the long-term request queue stability for cloud users. Then we propose an online and decentralized algorithm named GREEN to address the randomness of external workload, power price, and carbon emission rate. The proposed algorithm provably achieves arbitrary cost-delay tradeoffs, thereby enabling CSPs to make flexible scheduling choices toward the desired objective. Trace-driven simulations confirm the efficacy and adaptivity of GREEN in non-stationary environments.
