We discuss an algorithm that optimizes the driving style of a train. The objective is to minimize the electrical energy used for traction subject to constraints such as the travel time, speed limits, available traction power, etc. The optimization is based on a nonlinear point-mass model of the train, which includes the equations of motion and which considers the set point dependent efficiency of the propulsion system. A discrete dynamic programming algorithm is developed for the deterministic and efficient numerical solution of the nonlinear optimal control problem. Both simulation results and practical measurements indicate energy savings between 10 and 30%, depending on operating conditions. The algorithm forms a suitable basis for a nonlinear model-predictive controller operating in hard real time
