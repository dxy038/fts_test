This work studies the performance of the Modular Multilevel Converter (MMC) under unbalanced conditions when the internal circulating currents are controlled to follow a reference value given by Lagrange-based optimization applied in the abc frame. The Lagrange-based current reference calculation is constrained to ensure that the MMC is providing constant, non-oscillatory, power flow at the DC-side even the case the AC grid voltage is unbalanced. Such operation can be achieved by the investigated Lagrange-based control while either controlling the differential currents of the MMC to have only a DC-component or while minimizing the sum energy oscillations in each phase of the MMC. The objective of preventing DC power oscillations can also be achieved independently of the power control strategy applied to control the three-phase currents on the AC side of the converter. The operation of the MMC is studied with three different objectives for the control of the AC currents: 1) Constant instantaneous three-phase power with sinusoidal currents, 2) Balanced sinusoidal three-phase currents, and 3) Constant instantaneous reactive power with sinusoidal currents. The impact of these different AC power control strategies on the oscillations of capacitor voltages and stored energy in the MMC is then analyzed and discussed, verifying how the Lagrange-based control is always able to keep the DC power flow free of second harmonic oscillations.
