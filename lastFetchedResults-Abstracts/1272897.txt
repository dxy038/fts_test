Near infrared reflectance spectroscopy (NIRS) is a rapid and low-cost method that has been reported to provide accurate prediction of soil total carbon (Ct) and nitrogen (Nt) contents. However, methodological aspects such as sample preparation and set homogeneity have not been addressed extensively. The main objective of the paper was to assess how NIRS determination of Ct and Nt was affected by sample preparation (0.2 mm grinding vs. 2 mm sieving) and set heterogeneity (i.e. using the total set vs. texture or localised sets). The study was performed on a range of African and Brazilian Alfisols, Oxisols and Ultisols (297 samples, with 6–80% clay). The total set could be divided into a coarse-textured set, including samples from Burkina Faso and Benin mainly, and a clayey set, including samples from Brazil mainly. Calibration and validation procedures were carried out within the total set and within each of the two texture sets and the three localised sets (Burkina Faso, Benin, and Brazil). Prediction of Ct using first derivatives with SNV (standard normal variate) scatter correction, which was the most appropriate spectrum preprocessing method, was in general more accurate for ground than for sieved samples. The difference was decisive when the determination was carried out on the localised clayey set, moderate on total and texture sets, and unclear on localised coarse-textured sets. Prediction of Nt was less clearly affected by sample preparation, though grinding was useful for the localised clayey set and harmful for localised coarse-textured ones. Thus the effect of sample preparation on prediction accuracy depended on soil texture, which may explain the contradictory results reported in the literature, often referring to narrow soil ranges. Using the same preprocessing method, the accuracy of Ct prediction generally increased with set homogeneity (i.e. from total to texture sets and from texture to localised sets), providing that clayey sets were ground. This agreed with deductions drawn from comparison between earlier studies carried out with either homogeneous or heterogeneous sets. The effect of set homogeneity on Nt prediction could not, however, be clearly demonstrated by this study. In conclusion, the study confirmed the interest of NIRS for the rapid and accurate determination of Ct and Nt, especially when homogeneous sets including ground samples were used.
