In this paper, the electricity cost minimization problem is considered for a residential microgrid which consists of multiple households (users) equipped with renewable-based distributed energy resource (DER). Each user has a set of nonshiftable and shiftable loads. Bidirectional electricity transactions are allowed, and a dynamic pricing model for the purchasing/selling of electricity from/to the grid is proposed. In order to reduce the electricity cost, the following decisions needed to be made: 1) scheduling decisions for the shiftable loads; 2) purchasing/selling decisions for each user at each time slot; and 3) amount decisions of the electricity purchased/sold by the users. An optimization problem to minimize the total electricity cost is formulated to obtain the optimal amount of electricity consumed, sold, and purchased for each user, respectively. A centralized algorithm based on dynamic programming, Q-learning, and Lyapunov methods are proposed to solve the optimization problem with perfect information, with partial information, and without information of any time-varying parameters, respectively. For the latter two cases, distributed algorithms are designed for practical implementation. Simulation results show that the proposed schemes can provide effective management for household electricity usage and bidirectional transactions.
