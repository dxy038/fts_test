In this paper, we consider optimal power allocation for conventional and buffer-aided link adaptive energy harvesting (EH) relay systems, where an EH source communicates with the destination via an EH decode-and-forward relay {over fading channels}. In conventional relaying, source and relay transmit signals in consecutive time slots whereas in buffer-aided link adaptive relaying, the state of the source-relay and relay-destination channels {as well as the amounts of energy available at source and relay} determine whether the source or the relay is selected for transmission. Our objective is to maximize the system throughput over a finite number of transmission time slots for both relaying protocols. In case of conventional relaying, we propose an offline and several online joint source and relay transmit power allocation schemes. For offline power allocation, we formulate {a convex optimization problem} whereas for the online case, we propose a dynamic programming (DP) approach to compute the optimal online transmit power. To alleviate the complexity inherent to DP, we also propose several suboptimal online power allocation schemes. For buffer-aided link adaptive relaying, we show that the joint offline optimization of the source and relay transmit powers along with the link selection results in a mixed integer non-linear program which we solve optimally using the spatial branch-and-bound method. We also propose efficient online power allocation schemes for buffer-aided link adaptive relaying. Simulation results show that buffer-aided link adaptive relaying provides significant performance gains compared to conventional relaying but requires a higher complexity for computation of the power allocation solution. We also show that buffer-aided link adaptive relaying is more robust to changes in the EH rate than conventional relaying.
