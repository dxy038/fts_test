X-ray angiography, a powerful technique for the visualization of blood vessels, has been widely used in clinical practice. However, due to unavoidable motion of patient, the subtraction images often suffer from misregistration artifacts. In order to improve the quality of subtraction images, registration algorithms are often employed before direct subtraction of mask and live images. A novel multiresolution elastic registration algorithm is proposed for the registration of the digital angiographic images using thin-plate spline (TPS). Our main contribution is a multiresolution search strategy specifically designed for the template matching method. In this strategy, the mask image is decomposed to coarse and fine sub-image blocks iteratively using the pyramid approach. Experimental results show that the multiresolution refinement strategy is well adapted to the template matching method, and can achieve better performance than comparable single step algorithms, because local minima can be overcome by the gradual coarse-to-fine approach that also ensures convergence. Registration results of four typical similarity measures, namely energy of histogram of differences (EHD), mutual information (MI), correlation and sum of squared differences (SSD), are compared. Three different interpolation methods, including nearest-neighbor, bilinear and bicubic, are also tested and compared. The overall conclusion is that the multiresolution refinement algorithm based on EHD combined with the bicubic interpolation method is very robust and effective for the registration of X-ray angiography images, which can obtain sub-pixel registration accuracy and is fully automatic. In addition, the objective measurement method developed in this paper on simulated data makes it possible to quantitatively evaluate the quality of the elastic registration results
