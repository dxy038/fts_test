A highly desirable feature in storage video applications is uniform quality. Variable bit rate (VBR) coding has the potential to produce nearly constant quality throughout an entire movie. This can be defined as a bit allocation problem with a long-term constraint on distortion variation. We consider the optimal bit allocation with multiple constraints including disk capacity and the distortion bounds on the individual frames. We find the theoretical optimality conditions and propose a practical iterative solution based on the Lagrangian methods. While minimizing average distortion and distortion variation cannot be achieved simultaneously for a given bit budget, the proposed algorithms are able to efficiently balance the tradeoff between the two goals. The computational complexity of the exact rate-distortion (R - D) functions for real movies is addressed by a statistical R - D model proposed in this work. Based on the generic block-based motion compensated transform coding theories, the model is formed by a rate-quantization (R - Q) function and the corresponding distortion-quantization (D - Q) function. A novel two-pass MPEG-2 VBR encoder based on the proposed algorithms is developed for coding with long-term nearly constant quality. Experimental results are promising and the encoder effectively achieves the fit-to-disc function and at the same time controls objective quality variation. By incorporating basic subjective coding techniques into the encoder, significant visual quality improvement is observed during the subjective tests.
