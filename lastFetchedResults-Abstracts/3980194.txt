In this paper, a current-control strategy is proposed for voltage-source inverters in microgrids. The main objective of the proposed controller is to inject a clean sinusoidal current to the grid, even in the presence of nonlinear/unbalanced loads and/or grid-voltage distortions. The repetitive control technique is adopted because it can deal with a very large number of harmonics simultaneously. The proposed current controller consists of an internal model and a stabilizing compensator, which is designed by using the <i>H</i><sup>&#8734;</sup> control theory. It turns out that the stabilizing compensator may be simply an inductor. This leads to a very low total harmonic distortion (THD) and improved tracking performance. In order to demonstrate the improvement of performance, the proposed controller is compared with the traditional proportional-resonant, proportional-integral, and predictive deadbeat controllers. The control strategies are evaluated in the grid-connected mode with experiments under different scenarios: steady-state and transient responses without local loads, and steady-state responses with unbalanced resistive and nonlinear local loads. The proposed controller significantly outperforms the other control schemes in terms of the THD level, with the price of slightly slower dynamic responses.
