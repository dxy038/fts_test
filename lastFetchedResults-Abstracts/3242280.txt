In this paper, we consider the power allocation of the physical layer and the buffer delay of the upper application layer in energy harvesting green networks. We analyze the delay-optimal power allocation problem over fading channels. The total power required for reliable transmission includes the transmission power as well as the circuit power. The harvested power (which is stored in a battery) and the grid power constitute the power resource. The objective is to find a policy to minimize the buffer delay under the constraint on the average grid power. The policy is a two-dimensional vector with the transmission rate and the power allocation of the battery as its elements. In each transmission, the transmitter decides the transmission rate and the allocated power from the battery (the rest of the required power will be supplied by the power grid). A constrained Markov decision process (MDP) problem is formulated when the data arrival process, the harvested energy arrival process, and the channel process are Markov processes. We prove that the optimal policy can be obtained as follows. First, we solve the optimal rate through a reduced MDP problem that is only related to the average harvested energy but not the harvested energy arrival process. Second, the batteryÂ´s power allocation can be given based on the optimal rate. By analyzing the reduced MDP problem through the transformations to the average cost MDP and discount optimal MDP, we derive some structural properties of the optimal policy. Moreover, the closed-form expression is obtained for the independent and identically distributed (i.i.d.) cases.
