This work presents a generalized and versatile approach for controlling Modular Multilevel Converters (MMC), with three or more phases, by means of Lagrange Multipliers in the ABC frame. The resulting control method is suitable for operation of HVDC converters under both balanced and unbalanced AC grid voltages, since it is designed for eliminating oscillations in the DC power flow independently of the AC grid voltage conditions. This is achieved by the analytical resolution of a mathematical optimization problem using Lagrange multipliers in order to calculate the differential current references for the converter directly in the ABC frame. The resulting equation for current reference calculation is generalized by a weighting factor introduced in the objective function for the optimization problem, and this allows to select between the following two operating conditions or any intermediate point between them: I) minimum differential current oscillations (&#916;i<sub>diffk</sub>), or II) minimum capacitive phase energy oscillations (&#916;w<sub>&#931;k</sub>). Furthermore, the constraints defined in the optimization regulate the average energy distribution inside the MMC; i.e., the capacitive phase average energy sum (w<sub>&#931;k</sub>) and difference (w<sub>&#916;k</sub>) whilst ensuring non-oscillatory power output (P<sub>DC</sub>) on the DC terminals of the MMC.
