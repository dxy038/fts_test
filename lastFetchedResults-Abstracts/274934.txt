Intensity based registration (e.g., mutual information) suffers from a scalloping artifact giving rise to local maxima and sometimes a biased global maximum in a similarity objective function. Here, we demonstrate that scalloping is principally due to the noise reduction filtering that occurs when image samples are interpolated. Typically at a much smaller scale (100 times less in our test cases), there are also fluctuations in the similarity objective function due to interpolation of the signal and to sampling of a continuous, band-limited image signal. Focusing on the larger problem from noise, we show that this phenomenon can even bias global maxima, giving inaccurate registrations. This phenomenon is readily seen when one registers an image onto itself with different noise realizations but is absent when the same noise realization is present in both images. For linear interpolation, local maxima and global bias are removed if one filters the interpolated image using a new constant variance filter for linear interpolation (cv-lin filter), which equalizes the variance across the interpolated image. We use 2D synthetic and MR images and characterize the effect of cv-lin on similarity objective functions. With a reduction of local and biased maxima, image registration becomes more robust and accurate. An efficient implementation adds insignificant computation time per iteration, and because optimization proceeds more smoothly, sometimes fewer iterations are needed.
