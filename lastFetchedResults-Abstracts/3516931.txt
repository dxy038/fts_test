Recently, an adjoint variable method (AVM) for sensitivity calculations has been proposed for use with the method of moments solvers. In this paper, we extend this method to be suitable for application to multiport devices. The target objective function is usually represented in terms of the deviceÂ´s S-parameters. Our AVM obtains the sensitivities of the S-parameters with respect to all design variables using only one full simulation with additional overhead. This overhead is usually less than the computation time of a full simulation. An analytical expression for the adjoint excitation is derived, leading to stable sensitivities. The potential of the proposed technique is demonstrated by analyzing low-pass and bandpass filters. The results show very good agreement between the proposed AVM and the conventional finite-difference approach (FDA). Moreover, the AVM is always faster than the FDA. The speed-up factor increases as the size of the problem increases.
