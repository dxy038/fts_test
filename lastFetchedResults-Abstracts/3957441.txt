We consider the problem of maximizing the throughput of a multi-antenna cognitive radio (CR) network. With spatial multiplexing over each frequency band, a multi-antenna CR node controls its antenna radiation directions and allocates power for each data stream by appropriately adjusting its precoding matrix. Our objective is to design a set of precoding matrices (one per band) at each CR node so that power and spectrum are optimally allocated for the node and its interference is steered away from unintended receivers. The problem is non-convex, with the number of variables growing quadratically with the number of antenna elements. To tackle it, we translate it into a noncooperative game. We derive an optimal pricing policy for each node, which adapts to the nodeÂ´s neighboring conditions and drives the game to a Nash-Equilibrium (NE). The network throughput under this NE equals to that of a locally optimal solution of the non-convex centralized problem. To find the set of precoding matrices at each node (best response), we develop a low-complexity distributed algorithm by exploiting the strong duality of the convex per-user optimization problem. The number of variables in the distributed algorithm is independent of the number of antenna elements. A centralized (cooperative) algorithm is also developed. Simulations show that the network throughput under the distributed algorithm rapidly converges to that of the centralized one. Finally, we develop a MAC protocol that implements our resource allocation and beamforming scheme. Extensive simulations show that the proposed protocol dramatically improves the network throughput and reduces power consumption.
