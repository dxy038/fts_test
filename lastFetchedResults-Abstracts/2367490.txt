Application of the ensemble Kalman filter (EnKF) to parameter estimation problems in reservoir engineering has increased steadily in the last few years. This increase has been driven primarily by the ease of implementing this technique on large scale history matching problems and the relatively low computational cost (adjoint computation is unnecessary). Although EnKF is optimal for multivariate Gaussian model variables and linear data model, acceptable history matching results have been obtained for mild deviations from these optimality conditions. In the presence of strong nonlinearities and for problems with multimodal probability distribution functions (PDFs), the history matching results from implementing EnKF are generally poor.

s paper we present an approach to improving the performance of EnKF for history matching problems with multiple modes by proposing a two-stage ensemble-based technique. This type of problem is not handled well by the traditional EnKF or the ensemble smoother. Our proposed approach utilizes two data assimilation stages to generate conditional samples of the reservoir model around a mode of the posterior multimodal PDF. We demonstrate the applicability of this approach on a low-order reservoir model and show that compared to the standard EnKF, the two-stage ensemble-based technique improved the history match quality significantly and much better estimates of the model variables were obtained. Although the predictions from the final ensemble using our technique may not quantify the full prediction uncertainty, we note that the objective in this case is primarily to obtain acceptable matches to production measurements, which may be used to quantify some local uncertainty.
