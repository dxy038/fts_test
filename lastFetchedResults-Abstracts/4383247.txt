Active-reactive optimal power flow (A-R-OPF) in distribution networks (DNs) with embedded wind generation and battery storage systems (BSSs) was proposed recently. The solution was based on a fixed length in the charge and discharge cycle for daily operations of BSSs. This can lead to a low profit when the profiles of renewable generators, demand and prices vary from day to day. In this paper, we extend the A-R-OPF method by developing a flexible battery management system (FBMS). This is accomplished by optimizing the lengths (hours) of charge and discharge periods of BSSs for each day, leading to a complex mixed-integer nonlinear program (MINLP). An iterative two-stage framework is proposed to address this problem. In the upper stage, the integer variables (i.e., hours of charge and discharge periods) are optimized and delivered to the lower stage. In the lower stage the A-R-OPF problem is solved by a NLP solver and the resulting objective function value is brought to the upper stage for the next iteration. It can be shown through a case study that a flexible operation strategy will achieve a considerably higher profit than by a fixed operation strategy of BSSs.
