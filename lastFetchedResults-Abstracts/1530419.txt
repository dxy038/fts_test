The main goal of this work is to use mathematical modelling and numerical optimization to obtain the optimal purification of a polluted section of a river. The most common strategy consists of the injection of clear water from a reservoir in a nearby point. In this process, the main problem consists, once the injection point is selected by geophysical reasons, of finding the minimum quantity of water which is needed to be injected into the river in order to purify it up to a fixed level: this will be the aim of this paper. We formulate this problem as a hyperbolic optimal control problem with control constraints, where the state system is given by the 1D shallow water equations coupled with the pollutant concentration equation, the control is the flux of injected water, and the objective function is related to the total quantity of injected water and the pollution thresholds. We present the mathematical formulation of the environmental problem, deriving a first order optimality condition in order to characterize the optimal solutions (via the introduction of the adjoint system for the computation of the gradient of the cost function). Finally, we deal with the numerical resolution of a realistic problem, where a finite element/finite difference discretization is used, an optimization algorithm is proposed, and computational results are provided.
