This paper presents a dynamic programming method to build the optimal energy management for an island microgrid which comprises the PV system, diesel and battery energy storage system (BESS). The objective is to minimize the operation cost and to reduce emissions by scheduling distribution energy resources (DER) in microgrid. The constraints are given by the power balance between the production and consumption, and the capacity of each DER. The decision variables are the scheduling of DER power, the operation cost and the emissions. Simulations are carried out in order to evaluate the efficiency of the proposed method
