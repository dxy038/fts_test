This paper presents a multifunctional control strategy for the autonomous operation of a multi-bus medium voltage (MV) microgrid under nonlinear and unbalanced load conditions. The main objective is to effectively compensate the harmonic currents of nonlinear loads using electronically-coupled distributed generation (DG) units. The proposed control strategy consists of a multi proportional resonant controller (MPRC) with adjustable resonance frequency and a harmonic impedance controller (HIC). The MPRC and HIC are, respectively, proposed to regulate the microgrid voltage and to share the harmonic currents of the nonlinear loads among the DG units. A conventional droop scheme is also employed to share the average powers of the loads between the DG units. Moreover, a virtual negative-sequence impedance control loop is augmented to the proposed control system to compensate the negative-sequence currents of the unbalanced loads. The proposed strategy minimizes the flow of harmonic and negative-sequence currents in the MV lines of the microgrid by local compensation of harmonic and negative-sequence currents of the feeders. The performance of the proposed control scheme is verified by using digital time-domain simulation studies in the PSCAD/EMTDC software environment.
