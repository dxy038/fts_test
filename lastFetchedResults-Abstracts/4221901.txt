We develop on-line routing and wavelength assignment (RWA) algorithms for WDM bidirectional ring and torus networks with N nodes. The algorithms dynamically support all k-allowable traffic matrices, where k denotes an arbitrary integer vector [k<sub>1</sub>, k <sub>2</sub>, ..., k<sub>N</sub>], and node i, 1&#8804;i&#8804;N, can transmit at most k<sub>i</sub> wavelengths and receive at most k<sub>i</sub> wavelengths. Both algorithms support the changing traffic in a rearrangeably nonblocking fashion. Our first algorithm, for a bidirectional ring, uses <span style="font-family:Arial" class="MsoNormal">&#9484;</span>(&#931;<sub>i=1</sub><sup>N</sup>k<sub>i</sub>)/3<span style="font-family:Arial" class="MsoNormal">&#9488;</span> wavelengths in each ring direction and requires at most three lightpath rearrangements per new session request regardless of the number of nodes N and the amount of traffic k. When all the k<sub>i</sub>s are equal to k, the algorithm uses <span style="font-family:Arial" class="MsoNormal">&#9484;</span>kN/3<span style="font-family:Arial" class="MsoNormal">&#9488;</span> wavelengths, which is known to be the minimum for any off-line rearrangeably nonblocking algorithm. Our second algorithm, for a torus topology, is designed for the special case with all the k<sub>i</sub>s equal to k. For a square torus network with N nodes, the algorithm uses <span style="font-family:Arial" class="MsoNormal">&#9484;</span>k&#8730;N/2<span style="font-family:Arial" class="MsoNormal">&#9488;</span> wavelengths in each fiber, which is shown to be at most two times a lower bound obtained by assuming full wavelength conversion at all nodes. In addition, the algorithm requires at most &#8730;N-1 lightpath rearrangements per new session request regardless of the amount of traffic k.
