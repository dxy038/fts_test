In this paper a general optimal control problem is studied for the shape control of the conditional probability density functions (PDFs) of nonlinear stochastic systems. The controlled systems are described by general nonlinear ARMAX models with time-delays and with non-Gaussian inputs. A j-step ahead predictive cumulative cost function related to the time delay model is concerned as the control objective rather than an instantaneous performance index. A new relationship between the PDFs of the input and output is established after constructing a special joint conditional PDF between the auxiliary multiple inputs and outputs. Based on this relationship, explicit formulations to the construction of optimal controllers are obtained through the dynamic programming approach. Using the proposed predictive controllers, the conditional output PDFs can be made to follow the target one. Moreover, an approach is further developed to design a local stabilization suboptimal control strategy. It has been shown that these control algorithms can also be applied to the minimum entropy control for non-linear stochastic systems under a unified framework.
