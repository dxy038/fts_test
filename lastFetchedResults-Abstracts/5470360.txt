Assessment of blood flow velocity in Doppler images is of great importance in clinical studies and research. From the Doppler waveform envelope, numerous indices can be obtained, such as the pulsatility index, resistance index, and systolic/diastolic ratio, as well as acceleration of the blood through valves. The evaluation for the Doppler images is usually conducted offline and manually by the physicians. Fully-automatic detection of the envelope has the advantages of being convenient, time and labor saving. The main objective of this paper is to propose an automated technique based on image processing and computer vision algorithms for real-time tracing of the waveform envelope in a sequence of pulsed Doppler images. To this end, first we establish an information-theoretic image model and a statistical shape-driven dynamical model, which are used to address the large degree of noise and poor contrast common in this application. Relying upon these two models, we construct a discrete Kalman filter for the recursive estimation of the blood velocity envelope, while taking into account the measurement noise from these two sources. The models and Kalman filter form an adaptive weighting, closed-loop envelope tracing framework. We present the theory and implementation of our methodology, and demonstrate its ability to accurately trace the blood flow velocity in pulse wave Doppler images as well as its robustness to noise and computational efficiency.
