We consider the problem of scheduling packets over channels with time-varying quality. This problem has received a lot of attention lately in the context of devising methods for providing quality of service in wireless communications. Earlier work dealing with this problem considered two cases. One case is that the arrival rate vector is in the throughput region and then policies that stabilize the system are pursued. The other case is that all packet queues are saturated and then policies that optimize an objective function of the channel throughputs are investigated. In this paper, we address the case where no assumption on the arrival rates is made. We obtain a scheduling policy that maximizes the weighted sum of channel throughputs. Under the optimal policy, in the general case, the system may operate in a regime where some queues are stable, while the other become saturated. If stability for the whole system is at all possible, it is always achieved. The optimal policy is a combination of a criterion that gives priorities based on queue lengths and a strict priority rule. The scheduling mechanism switches between the two criteria based on thresholds on the queue lengths and is modulated by the availability of the channels. The analysis of the operation of the system involves the study of a vector process which in steady state has some of its components stable while others are unstable. We adopt a novel model for time-varying channel availability that dispenses with the statistical assumptions and makes a rigorous description of system dynamics possible.
