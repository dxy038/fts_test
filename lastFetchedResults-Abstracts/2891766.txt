A Virtual Power Plant (VPP) concept is utilized to manage multiple geographically dispersed energy resources. The purpose is to incorporate Distributed Energy Resources (DERs), Photovoltaic (PV) and energy storage units into the grid and to realize their economic and stable cooperation in a liberalized energy market. The paper proposed a centralized two-level hierarchical VPP controller to address both its commercial concerns and the participation into the energy market as well as the ancillary service market. The controller targets are attained with the Model Predictive Control (MPC) strategy, with different objective functions and constraints in the two levels. The primary control employs the Lasso MPC approach to allocate power imbalance commands between PV energy system and the Battery Energy Storage System (BESS). The secondary control mainly considers the income of the VPP, minimizing power purchase from the utility grid. Finally, a numerical demonstration is conducted using lumped system models, real weather and solar insolation data, as well as load data from the grid.
