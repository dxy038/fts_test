In this paper we analyze the feasibility of performing Quantum Key Distribution (QKD), in Earth-satellite up and downlinks and in intersatellite links, with two quantum cryptography protocols: BB84 and SARG04, and with two implementation options: with and without decoy states. As real measurements in these scenarios are not possible yet, the objective is to obtain results as realistic as possible to support the design of future satellite missions performing QKD. Therefore, we use realistic values for the optical hardware and take into account usual atmospheric conditions. In the same line, we assume specific types of attacks, namely the photon number splitting and the intercept-resend with unambiguous discrimination attacks, which could likely be the main threat to the first satellite-based QKD applications. A lower bound on the key generation rate of SARG04 with two decoy states is presented. The optimum signal- and decoy-states mean photon numbers for each protocol and each distance are also computed. The resulting values for the signal-state are larger than those often employed. We show that it may be possible to establish QKD with LEO (Low Earth Orbit) and, under certain circumstances, with MEO (Medium Earth Orbit) satellites, but not with GEO (Geostationary) ones. Furthermore, we obtain that the optimum signal-state mean photon number for SARG04 with two decoy states is almost independent of the link distance, which greatly facilitates its use in a real scenario.
