The key elements in an indirect V2G system architecture are aggregators. They act as an interface between the grid and a group of plug-in hybrid electric vehicles (PHEVs). In this paper, we design an optimal vehicle to grid (V2G) aggregator to control the charging and frequency regulation processes of a group of PHEVs. We consider a problem that an aggregator has to minimize the overall cost of PHEV fleet in a multiple time slot horizon and meet the required battery level when PHEVs plug out. We adopt summation of PHEVs´ expenditure in a finite number of time slots as our objective function, which is a quadratic optimization problem. A model predictive control based (MPC-based) PHEV charging and regulation algorithm is proposed to schedule the charging and regulation processes. Through the numerical experiments, we obtain the optimal charging and frequency regulation sequences for each PHEV, the effect of price prediction error on PHEV´s cost as well as the impact of penalty factor to plug-out State of Charge (SOC). It is also shown that by taking the optimal control sequences, the PHEV owner can reduce his cost and depart with desired SOC.
