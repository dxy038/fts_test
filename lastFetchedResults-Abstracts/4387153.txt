We examine the problem of a generator offering generation and ancillary services from a set of cascaded hydroelectric units to a centrally dispatched market that does not account for watershed constraints. By modeling the least-cost dispatch problem and computing the resulting schedules and market prices, we formulate a stochastic bilevel optimization problem that maximizes the generator´s expected profits under different demand and supply realizations. To account for potential infeasibilities in the resulting hydroelectric dispatch, we include penalties in the generator´s objective function. We propose a simple technique that replaces the lower-level dispatch problem with its linearized Karush-Kuhn-Tucker optimality conditions to convert the problem to a single-level mixed-integer program. We use two numerical case studies, based on actual river systems, to demonstrate the benefits of the proposed model.
