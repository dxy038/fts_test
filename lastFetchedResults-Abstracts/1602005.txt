Coupling shape optimization to three-dimensional unsteady cardiovascular simulations poses several key challenges, including high computational cost, a need to handle constraints, and a need for automatic generation of parameterized vessel geometry. In this work we extend our previous framework for cardiovascular optimization to include constraints, pulsatile flow under both rest and exercise conditions, and multiple geometric parameters. Optimization is performed using a derivative-free algorithm called the surrogate management framework, with constraints enforced using a filter method. In this work, we examine a specific surgery called the Fontan, which is performed to treat single-ventricle heart patients. These patients typically undergo a series of three surgeries, the last of which connects the inferior vena cava to the pulmonary arteries. Our group and others have recently proposed and evaluated a new Y-graft modification of the Fontan operation that replaces the current tube shaped baffle. Preliminary simulations have shown that the Y-graft modification is a promising design that increases energy efficiency and improves flow distribution to the pulmonary arteries. In this work, we perform optimization on a model Y-graft design problem. This work represents the first use of formal design optimization methods for the Fontan surgery, and also demonstrates the applicability of the optimization framework on a pulsatile flow problem with multiple design parameters and constraints. The idealized Y-graft model was parameterized with six geometric parameters including graft diameter and anastomosis locations, and the optimization procedure, including model construction, meshing, and simulation, was executed automatically. Energy efficiency was chosen as the objective function. A constraint on the wall shear stress (WSS), a presumed correlate to thrombosis risk, was added to the problem using a filter method, which allowed for exploration of the trade-offs between WSS and energy efficiency. Optimization was performed at two exercise levels with effects of respiration incorporated, and differences in optimal solutions were examined. It was shown that optimal shapes differed between rest and exercise, as well as steady and pulsatile flow conditions, with wide-span branches and decreasing graft branch size favored with increasing exercise level. The optimization method was found to be robust for different polling strategies, and computationally efficient both with and without constraints.
