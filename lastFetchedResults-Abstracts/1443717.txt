This paper extends the existing results on joint input and state estimation to systems with arbitrary unknown inputs. The objective is to derive an optimal filter in the general case where not only unknown inputs affect both the system state and the output, but also the direct feedthrough matrix has arbitrary rank. The paper extends both the results of Gillijns and De Moor [Gillijns, S., &amp; De Moor, B. (2007b). Unbiased minimum-variance input and state estimation for linear discrete-time systems with direct feedthrough. Automatica, 43, 934–937] and Darouach, Zasadzinski, and Boutayeb [Darouach, M., Zasadzinski, M., &amp; Boutayeb, M. (2003). Extension of minimum variance estimation for systems with unknown inputs. Automatica, 39, 867–876]. The resulting filter is an extension of the recursive three-step filter (ERTSF) and serves as a unified solution to the addressed unknown input filtering problem. The relationship between the ERTSF and the existing literature results is also addressed.
