The increasing integration of new technologies for power generation into the smart grid systems calls for novel demand response (DR) algorithms, which schedule the appliances to minimize cost and maximize comfort for the users. Traditionally, the formulations of the DR problem consider unidirectional energy flow from the power grid (energy supplier) to the user in a residential building (energy consumer). In this paper, we argue for an extended model of a smart residential building with bidirectional energy trading. This model allows the user to sell the surplus energy, obtained from local renewable energy sources, so as to partially recover the electricity cost. We further study an efficient linear model for appliance scheduling, under the assumption of bidirectional energy trading. To balance the user comfort and electricity cost, we introduce a comfort demand function based on declining block rates (DBR) and discuss the microeconomic meaning of this function. We evaluate our method with several case studies and analyze how energy selling and comfort demand affect the total cost and the schedule. We also show that our scheduler is fast enough to allow for nearly realtime scheduling adjustments ahead of each period, to minimize the impact of forecast deviations.
