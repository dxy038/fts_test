In this paper we study how to design an opportunistic scheduler when flow sizes have a general service time distribution with the objective of minimizing the expected holding cost. We allow the channel condition to have two states which in particular covers the important special case of ON/OFF channels. We formulate the problem as a multi-armed restless bandit problem, a particular class of Markov decision processes. Since an exact solution is out of reach, we characterize in closed-form the Whittle index, which allows us to define a heuristic scheduling rule for the problem. We then particularize the index to the important subclass of distributions with a decreasing hazard rate. We finally evaluate the performance of the proposed Whittle-index based scheduler by simulation of a wireless network. The numerical results show that the performance of the proposed scheduler is very satisfactory.
