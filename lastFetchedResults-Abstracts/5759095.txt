This paper develops a new version of time-varying shortest path problem. Let G = (V, E) be a directed graph. A set of perishable products will be transferred by vehicles from source s to destination d. Each arc eepsiE has four parameters: transit time b(e, n<sub>2</sub>, u), transit cost c(e, n<sub>2</sub>, u), vehicle cost S(e, n<sub>2</sub>, u, t) and vehicle switching cost I(n<sub>1</sub>; n<sub>2</sub>), which are functions of the departure time u at the beginning vertex of the arc, the current time t and the vehicle type used previously n<sub>1</sub> and currently n<sub>2</sub>. What is more, product depreciation value during the time interval [t<sub>1</sub>, t<sub>2</sub>] is expressed as Delta(t<sub>1</sub>, t<sub>2</sub>) = V(t<sub>1</sub>) -V(t<sub>2</sub>), where V(t) is the function of product value at time t. Furthermore, postponement of departure (i.e., waiting) at a vertex is prohibited. In addition, the vehicle type can be switched when arriving at one vertex. The objective is to find the shortest path, delivering the product from source s to destination d with the minimum cost, which is the sum of transit cost, vehicle cost, vehicle switching cost and product depreciation value, subject to the constraint that the total transit time is at most some number T. Algorithm SP-ZWT with pseudo polynomial time complexity is proposed to optimally solve the problems.
