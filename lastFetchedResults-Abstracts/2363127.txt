An increasingly popular approach to improving semi-empirical (SE) methods for modeling London dispersion and hydrogen-bonding interactions is to correct deficiencies in the SE method through the addition of empirical potentials. Improving the description of hydrogen-bonding is inherently the more difficult task. While semi-empirical methods neglect dispersion interactions, the correct functional form of dispersion at long-range is known and may be added as an empirical correction. By contrast, no theoretically justified analytic form is known that describes H-bonding and moreover, H-bonding forces are already partially incorporated at the SE level due to their partial electrostatic nature (unlike dispersion interactions). Given their partial electrostatic nature, one reasonable approach to improving the ability to model H-bonding interactions is to incorporate an empirical potential that depends on the atomic charges of the atoms involved in hydrogen-bonding. While this approach has been used several times with success, typically the empirical correction is added subsequent to convergence of the SCF procedure. This approximation neglects the fact that the correction term and the density matrix are interdependent and consequently results in a quantitatively incorrect electronic energy, which leads to an incorrect prediction of the potential minimum upon geometry optimization. The objective of this article is to describe how a correction function that depends on the atomic charges can be incorporated in a self-consistent manner, thereby avoiding the mentioned shortcomings. To do so requires adding the gradient of the correction with respect to the atomic charges to the Fock operator.
