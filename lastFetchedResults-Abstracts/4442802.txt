Precise control of neural circuits via microstimulation is an indispensable but challenging objective in neuro-engineering. The effect of electrical stimulation is imprecise and has a spatio-temporal blurring. At the neuron level, the effects are obfuscated by the complexity of neural dynamics. This paper proposes an online multiple-input-multiple-output (MIMO) adaptive inverse controller for somatosensory microstimulation. The control of the target firing pattern is achieved by including an adaptive controller before the stimulator whose transfer function is always adjusted to be the inverse of the neural circuit transfer function. In this paper a synthetic neural circuit is built from LIF neurons to model the neural circuit. Considering a Poisson model for the target spike train, we identify the LIF neural model using a Generalized Linear Model (GLM) fitted with a maximum likelihood (ML) criterion. The controller architecture becomes the inverse of the GLM and its parameters are periodically adjusted to ensure that the input to the LIF model approximates the target spike time response. In synthetic data, the results show that this control scheme successfully determines the impulse timing and amplitude of the desired stimuli and drives the dynamic neural circuit output to follow the target firing pattern. With the simulated model, the method is able to preserve the temporal precision of neural spike trains.
