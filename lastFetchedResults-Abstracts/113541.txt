This paper develops a multicommodity flow model to optimize water distribution and water quality in a regional water supply system. Waters from different sources with different qualities are considered as distinct commodities that concurrently share a single water distribution system. The model can accommodate two-way flow pipes, represented by undirected arcs, and the perfect mixing condition. Additionally, blending requirements are specified at certain control nodes within the system to ensure that downstream users receive the desired water quality. The optimization model is highly nonlinear and solved by a hybrid genetic algorithm (GA). The GA is first used to globally search for the directions of all undirected arcs. Then a generalized reduced gradient (GRG) algorithm embedded in the GA is used to optimize the objective function for fitness evaluation. The proposed methodology was first tested and verified on a hypothetical system and then applied to the regional water distribution system of the Metropolitan Water District of Southern California. The results obtained indicate that the proposed hybrid GA is a viable way of converting an undirected network to a directed network by separating the complicating variables, and that the resulting directed network model can be solved iteratively and efficiently by a gradient-based algorithm.
