The magnets used in a family of inside-out nuclear magnetic resonance (NMR) well-logging tools usually consist of several segments of magnet materials, with each segment magnetized differently. In a tool, the magnet is surrounded with a nonlinear magnetic material, such as ferrite or steel, that is primarily used in the RF coil or in shielding the electronic components from strong magnetic fields. The main objective of the tool design is to find a set of magnetization vectors that result in a desired magnetic field profile in a particular region. A typical nonlinear finite-element method (FEM) model of such a design has about quarter of a million unknowns and requires about 35 h of processor time on a Sun Ultra 60 296-MHz machine with 1 GB of RAM. It generally requires many executions of the nonlinear FEM to arrive at a satisfactory design. In this paper, an optimal control technique in conjunction with FEM is proposed to speed up the design process. A magnet built from the design showed excellent agreement between the measured and computed data and validated the numerical method
