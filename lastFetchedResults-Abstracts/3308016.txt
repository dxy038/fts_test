We consider the full inverse treatment planning (FITP) problem that arises in spot-scanning ion therapy. This inverse problem is to find optimal trajectories, energies and fluences of a fixed number of particle beams with the objective of delivering a prescribed dose to a target volume without irradiating nearby critical structures. Despite its potential spin-offs, FITP is rarely considered because it leads to a very challenging optimization task. Our contribution is twofold: (i) we show that FITP can be solved accurately using simulated annealing, and (ii) we construct efficient and theoretically sound candidate-solution generation mechanisms that speed up the annealing process by a factor of the order of 100.
