This paper presents a generalized and versatile control approach using Lagrange multipliers in the ABC frame for a modular multilevel converter-based HVDC system. The methodology is capable of analytically obtaining desired operative conditions by calculating the differential current references previously established by the constraints in the optimization formulation, while obtaining the result with minimum: 1) differential current oscillations (&#916;i<sub>diffk</sub>) or 2) capacitive phase-energy oscillations (&#916;&#969;<sub>&#931;k</sub>). Furthermore, the energy distribution inside the MMC (i.e., the capacitive phase average energy sum (&#969;&#773;<sub>&#931;k</sub>) and difference (&#969;&#773;<sub>&#916;k</sub>)) is being regulated by means of the constraint definitions. The optimization yields a differential current reference in &#8220;abc&#8221; coordinates with a similar structure to instantaneous power theories: as the addition of the product between varying conductances and the MMC internal dynamics input voltages (i.e., the dc bus voltage (v<sub>dc</sub>) and the MMC load electromotice force (emf) (e<sub>vk</sub>) on the one hand; and a contribution proportional to the ac load power (e<sub>vk</sub>i<sub>vk</sub>) on the other. Both the objective function minimization and the energy constraints are achieved with one single current reference resulting from the optimization process, without the application of linear superposition techniques.
