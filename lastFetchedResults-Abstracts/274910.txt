In this paper, we present a novel deformable registration algorithm for diffusion tensor MR images that enables explicit optimization of tensor reorientation. The optimization seeks a piecewise affine transformation that divides the image domain into uniform regions and transform each region affinely. The objective function captures both the image similarity and the smoothness of the transformation across region boundaries. The image similarity enables explicit orientation optimization by incorporating tensor reorientation, which is necessary for warping diffusion tensor images. The objective function is formulated in a way that allows explicit implementation of analytic derivatives to drive fast and accurate optimization using the conjugate gradient method. By explicitly optimizing tensor reorientation, the algorithm is designed to take advantage of similarity measures comparing tensors as a whole. The optimal transformation is hierarchically refined in a subdivision framework. A comparison with affine registration for inter-subject normalization of 8 subjects shows that the proposed algorithm improves the alignment of several major white matter structures examined: the anterior thalamic radiations, the inferior fronto-occipital fasciculi, the corticospinal/corticobulbar tracts and the genu and the splenium of the corpus callosum. The alignment of white matter structures is assessed using a novel scheme of computing distances between the corresponding fiber bundles derived from tractography.
