Due to the increase in electricity energy consumption and the fact that about 90 % of fuels being used now are co2 pollutant and the crisis has been caused by greenhouse gases have made moving toward renewable energies unavoidable. Fortunately, with the cooperation and control of DG units, we can fortify the distribution networks that will finally transform the current networks to decentralized networks. This would be achieved by means of Virtual Power Plants (VPP). This paper examines the dynamic programming optimization of a VPP. Objective function being used in this article is the maximization of profit considering the risk that can be tolerated. From a system operator point of view, this will help prevent congestion and price spikes and better use of distributed resources. Numerical results for a case study are discussed. The results indicate that utilization of controllable loads and storage systems (electrical and heat) can facilitate the optimal scheduling of VPP with higher profit or lower operational cost.
