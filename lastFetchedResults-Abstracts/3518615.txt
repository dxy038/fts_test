Two auxiliary transfer-function matrices called weighted-input-to-state and state-to-weighted-output transfer-function matrices are first introduced. Based on these matrices, the controllability and observability grammians of the weighted system are defined and the existence of the grammians is justified. Then a method is developed for the computation of the grammians in terms of unconstrained minimizations in which good initial points are provided for the minimizations. The objective function in the required minimizations is modified by including a term which depends on the Hankel singular values to be discarded. The method is then implemented as a step-by-step algorithm. As will be shown, the method generates a weighted structurally balanced approximation which yields a quadratically stable reduced-order system regardless of the system order. The method is illustrated by designing a lowpass 2-D filter of order (4,8)
