This paper considers a novel control strategy for energy storage systems in networks with high penetration of renewable power and limited network capacity based on the combination of model predictive control (MPC) and hierarchical optimization. The objective is to maximize the output, hence the income, from the renewable generation using appropriate charging and discharging control strategy for energy storage systems based on the prediction of renewable power output, demand and network capability in future time horizon. The battery energy storage system can be used to smooth out the variations in renewable energy such as, wind power, and maximize renewable power output whilst meeting the system constraints. Furthermore network interconnection capacity with other systems must be honored. Network interconnection capability depends on many factors including demand and flexible/inflexible generation within the network and also the external systems. In this paper, we show how this problem can be formulated as an optimization problem, leading directly to the design of a model predictive controller. In this scheme, the optimal control for energy storage systems is implemented in a receding time horizon. The method is applied as a case study to the modified IEEE-30 bus test system and northwest power grid of China.
