Nowadays microgrids have been widely considered due to their economic and technical features. The most important feature of microgrid is its flexibility which means microgrids are be able to operate in both grid-connected and islanded operation modes. This paper presents a bi-level scheduling model for optimal operation of an integrated microgrid between grid-connected and islanded modes by using Benders decomposition method. Also a neighbor microgrid is considered in the model and it is assumed that the main microgrid enables to exchange energy with its neighbor just in the islanding mode through a call option contract. The proposed model consists of a master problem for the grid-connected operation mode and a sub-problem for the islanding operation mode. The objective function of the master problem minimizes microgrid operation cost including cost of fuel, start up, spinning reserve as well as purchasing power from main grid or neighbors. However, the objective function of the sub-problem investigates whether the power generation of the microgrid is enough or the loads can be supplied continuously in the islanding mode of microgrid. Uncertainties of distributed energy sources, energy price and load are modelled by two-point estimate method.
