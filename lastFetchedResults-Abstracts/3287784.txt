This document presents a three-phase grid-connected power injection system for a photovoltaic power source with control of the injected active power through an energy storage system based on ultracapacitors. The ultracapacitor technology offers high power density that matches properly in a Smart-Grid scenario with the need of active power regulation for quasi-manageable energy ability. A voltage source inverter injects the power into the grid, while a bidirectional direct current converter regulates the charge of the ultracapacitor. In this way, the ultracapacitor could be charged when the active power needed in the grid is below the photovoltaic power, it could be discharged in the opposite case, and, if the ultracapacitor is saturated the power point tracked depends on the reference, injecting the desired active power in every assumption. The system has been implemented in a prototype through a FPGA/processor controller, so the hardware/software co-design is detailed. Finally, the performance of the configuration is exposed via experimental tests.
