A complete theoretical treatment for modeling erbium-doped waveguide amplifiers (EDWAs) by the method of lines (MoL) numerical scheme is presented. Though a similar approach has previously been applied to the treatment of bent amplifiers, the present procedure is generalized by the inclusion of amplified spontaneous emission (ASE) and bidirectional pumping, which were not included in previous treatments. An iterative scheme is described and its convergence verified. The scheme accounts for the coupling that arises between all the otherwise independent length increments when bidirectional propagation of either pumping or ASE occurs. Since the method uses the electric field rather than the intensity profile, a new treatment of the ASE based on randomizing the phase of the field by the application of a Brownian random process is accordingly developed. Additional information on the ASE power coupled to the whole set of amplifier modes and on the spatial dependence of the noise is obtained. This allows for more effective analysis of the noise figure of devices such as mode evolution couplers, for which mode interference is of primary importance. The theoretical results are compared with experiments, and with results obtained by previous methods applied to similar problems
