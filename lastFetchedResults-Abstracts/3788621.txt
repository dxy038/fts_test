The theoretical foundations and the numerical performance of an advanced nonlinear circuit simulator based on the piecewise harmonic-balance (HB) technique are discussed. The exact computation of the Jacobian matrix for Newton-iteration based HB simulation and the related conversion-matrix technique for fast mixer analysis are formulated in a general form. Convergence problems at high drive levels are solved by a parametric formulation of the device models coupled with an advanced norm-reducing iteration. A physics-based approximation is shown to allow the HB equations to be effectively decoupled in many practical cases, bringing large-sized jobs, such as pulsed-RF analysis, within the reach of ordinary workstations. The exact Jacobian is used in conjunction with an exact formula for the gradient of the objective function, to implement an efficient broadband nonlinear circuit optimization capability. Examples are presented
