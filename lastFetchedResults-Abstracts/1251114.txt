In this paper, optimal operating rules for water quality management in reservoir–river systems are developed using a methodology combining a water quality simulation model and a stochastic GA-based conflict resolution technique. As different decision-makers and stakeholders are involved in the water quality management in reservoir–river systems, a new stochastic form of the Nash bargaining theory is used to resolve the existing conflict of interests related to water supply to different demands, allocated water quality and waste load allocation in downstream river. The expected value of the Nash product is considered as the objective function of the model which can incorporate the inherent uncertainty of reservoir inflow. A water quality simulation model is also developed to simulate the thermal stratification cycle in the reservoir, the quality of releases from different outlets as well as the temporal and spatial variation of the pollutants in the downstream river. In this study, a Varying Chromosome Length Genetic Algorithm (VLGA), which has computational advantages comparing to other alternative models, is used. VLGA provides a good initial solution for Simple Genetic Algorithms and comparing to Stochastic Dynamic Programming (SDP) reduces the number of state transitions checked in each stage. The proposed model, which is called Stochastic Varying Chromosome Length Genetic Algorithm with water Quality constraints (SVLGAQ), is applied to the Ghomrud Reservoir–River system in the central part of Iran. The results show, the proposed model for reservoir operation and waste load allocation can reduce the salinity of the allocated water demands as well as the salinity build-up in the reservoir.
