The adjoint method is a powerful tool in geophysics that permits the computation of the exact first derivative of a physical observable or an associated objective function with respect to its parameters. Typical observables are displacement fields and flow patterns at the surface. Possible geophysical parameters are density, viscosity or elastic coefficients. When the observable can be modelled by solving a differential equation, the computation of the derivative only consists in solving the forward problem and its adjoint problem. Therefore, the adjoint method is far more efficient than any finite difference approximation. Here we present a mathematical formalism that generalises the derivation of the adjoint problem. In order to connect to work by Tarantola [Tarantola, A., 1984. Inversion of seismic reflection data in the acoustic approximation. Geophysics 49 (8), 1259–1266] we first give a derivation of the adjoint equations for the scalar wave equation in two dimensions. As objective function we choose the L 2 distance between the modelled wave field and real data. In this case the adjoint problem coincides with the original forward problem, the only difference being that the adjoint field satisfies terminal rather than initial conditions. A numerical example in two dimensions demonstrates that the adjoint field focusses near the location of a parameter perturbation at the same time when the original wavefront reaches that location. Based on this simple example, we introduce a generalised formalism for the adjoint method. It is independent of the existence of Green’s functions and their spatio-temporal reciprocity relations. Moreover, the formalism applies to non-linear equations such as the Navier–Stokes equations. This may become important in mantle flow reconstructions. The source term of the adjoint equations depends only on the specific objective function. Choosing the objective function to coincide with the observable itself allows us the computation of Jacobians, i.e., the derivative of the observable with respect to the model parameters. To demonstrate the consistency of our formalism with earlier analyses, we consider the anisotropic elastic wave equation with attenuation, which is of major interest in seismology.
