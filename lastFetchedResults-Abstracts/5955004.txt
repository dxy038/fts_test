Patient movement deteriorates image quality in medical imaging. For many applications, such as respiratory movement, image registration is being used to try to combine several (noisy) images into one high quality image. Non-rigid image registration is in many cases however an ill-posed problem. Even though images can be registered, the underlying deformation fields can be non-realistic and/or non-unique. Fidelity to the meaning of the image can help to reduce such problems. In PET and SPECT, voxel values represent concentration of the radiotracer. Therefore, if an organ such as a lung gets compressed, the image values increase. Similarly, density increases, and therefore CT Hounsfield units will change. In most approaches for image registration, these changes in image values are ignored. Here we use a (penalised) least-squares objective function, modified to take the change in image values due to local stretching/compression into account by multiplying the transformed image with the Jacobian-determinant of the transformation, as previously suggested by a number of authors. However, we minimize this objective function using a free-form deformation field (i.e. parametrised by a deformation vector for every voxel). To do this, we derive formulas for the derivative of the objective function w.r.t. the deformation vectors, which allows us to use a simple gradient descent algorithm to find the penalised least-squares solution. Our results indicate that the resulting objective function leads to unique solutions, even in uniform regions. However, regularisation is essential to prevent noise being registered as well.
