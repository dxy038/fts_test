This paper presents an optimal relay precoding scheme for two-hop amplify-and-forward based MIMO relay networks with one source, one destination and multiple relays. A constrained optimization problem for relay precoder is formulated by using the mutual information criterion along with a total relay transmitting power constraint. It is shown that due to the block-diagonal structure of the precoding matrix, the optimization problem can not be solved directly by the existing methods. We then simplify it into an equivalent problem involving scalar optimization variables only. Through an in-depth study of the problem formulation, it is revealed that the objective function is convex only when the relay power is larger than a certain threshold, which can be determined mainly by the system configurations and the channel condition. Finally, under the convex condition, the simplified problem is solved by a convex optimization method. The effectiveness of the proposed precoder is validated by Monte-Carlo simulations with comparison to some of the existing methods.
