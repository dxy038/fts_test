We propose a multiple-input multiple-output (MIMO) two-way relaying based underlay device-to-device (D2D) communication system, in which relay uses physical layer network coding (PNC). Both cellular and D2D communication take place in the same spectrum. D2D communication is based on PNC, and a joint transceiver design is required to facilitate PNC mapping with MIMO channels. A joint precoder-decoder scheme is also considered in the cellular communication to mitigate interference, and improve the error performance. Mean square errors at nodes are considered as the objective function, and interference threshold limits and power constraints are also used in joint precoder-decoder design problems. These turn out to be non-convex optimization problems, and we propose two algorithms in both phases of D2D and cellular communication. Distributed optimization methods are used in the proposed algorithms. We analyze the convergence of proposed algorithms, and the system performances are investigated with different D2D pair locations, interference constraint thresholds, and maximum available power at nodes.
