A comparison is made of two different implementations of the finite element method (FEM) for calculating the potential due to dipole sources in electroencephalography (EEG). In one formulation (the direct method) the total potential is the unknown that is solved for and the dipole source is directly incorporated into the model. In the second formulation (the subtraction method) the unknown is the difference between the total potential and the potential due to the same dipole in an infinite region of homogeneous conductivity, corresponding to the region where the dipole is located. Both methods have the same FEM system matrix. However, the subtraction method requires an additional calculation of flux integrations along the edges of the elements in the computation of the right-hand side (RHS) vector. It is shown that the subtraction method is usually more accurate in the forward modeling, provided the flux integrations are computed accurately. Errors in calculating the flux integrations may result in large errors in the forward solution due to the ill-conditioned nature of the FEM system matrix caused by the Neumann boundary condition. To minimize the errors, closed-form expressions for the flux integrations are used for both linear and quadratic triangular elements. It is also found that FEM forward modeling errors may cause false extrema in the least-square objective function obtained from the boundary potential, near boundaries between media of differing conductivity. Multiple initial guesses help eliminate the possibility of the solution getting trapped in these false extrema.
