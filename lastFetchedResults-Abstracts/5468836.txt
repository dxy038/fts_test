A microgrid power system with multiple energy sources and loads is considered in this paper. Such microgrids are common due to the needs of distributed generation, renewable energy, and hybrid power sources. The system under study consists of a large number of power converters operating over a wide range of voltages and currents, interconnected via a distribution network. Stability analysis and supervisory control design requires a good model of the system that considers different operations within the microgrid, such as voltage/current levels, bidirectional power flows, and on/off switching of the power converters. In this paper, a state variable modeling approach is presented to develop a hybrid large-scale system model of the microgrid. State variable models of individual converters linearized at different operating points are the building blocks of the model. A large-scale interconnected system model is developed for each feasible interconnection of the linearized models of the converters. The switching model, which is a combination of state based and input based switching events between these large- scale system models, is developed using hybrid system theory. The modeling approach is applied to two example systems consisting of DC-DC converters and a DC bus. The hybrid large scale system models are compared with circuit simulations to show the validity of the modeling process.
