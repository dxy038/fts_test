We aim to enhance the end-to-end rate of a general dual-hop relay network with multiple channels and finite modulation formats, by jointly optimizing channel pairing, power allocation, and integer bit loading. Such an optimization problem has both a discrete feasible region, due to the combinatoric nature of channel pairing, and a discrete objective, due to the bit loading requirement. For this type of mixed-integer programming problems, the Lagrange dual method generally is inapplicable, due to the non-zero duality gap. However, by exploring the structure of our problem, we are able to bound the gap to within one bit, allowing the extraction of an exact optimal integer solution. We further present complexity reduction techniques, and demonstrate that the proposed solution only requires a computational complexity that is polynomial in the number of channels, realizing efficient implementation in practical systems. Through numerical experiments, we show that the jointly optimal solution can significantly outperform common sub-optimal alternatives.
