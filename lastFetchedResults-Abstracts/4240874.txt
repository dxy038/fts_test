To register pre-operative MRI/CT images with intra-operative ultrasound images based on the vessels visible in both of the modalities, we presents a non-rigid registration method of multimodal medical images based on free form deformation was proposed. When the images are aligned, the centerline points of the vessels in one image will align with the intensity ridge points in the other image. Rigid transformation was adopted in global registration while local deformation was described by a free form deformation (FFD) based on a modally controlled B-spline. The method applies an optimization strategy combining the genetic algorithm with the conjugated gradients algorithm to minimize the objective function. Two experiments were designed on phantom and clinical data to evaluate the method. The results indicate that the registration method is consistent and suggest that it is accurate. The average standard deviation of the final transformation parameters is sub-voxel, sub-millimeter, and within 0.010 radians. The results show that the method has good registration accuracy and convergence rate. And it can be applied efficiently in the ultrasound-image-guided surgery system
