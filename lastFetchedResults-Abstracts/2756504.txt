In this paper, we propose a two-step Bayesian approach to handle the ill-posed nature of the unmixing problem for accurately estimating the abundances. The abundances are dependent on the scene contents and they represent mixing proportions of the endmembers over an area. In this work, a linear mixing model (LMM) is used for the image formation process in order to derive the data term. In the first step, a Huber-Markov random field (HMRF)-based prior distribution is assumed to model the dependencies within the abundances across the spectral space of the data. The threshold used in the HMRF prior is derived from an initial estimate of abundances obtained using the matched filters. This makes the HMRF prior data-driven, i.e., dHMRF. Final abundance maps are obtained in the second step within a maximum a posteriori probability (MAP) framework, and the objective function is optimized using the particle swarm optimization (PSO). Theoretical analysis is carried out to show the effectiveness of the proposed method. The approach is evaluated using the synthetic and real AVIRIS Cuprite data. The proposed method has the following advantages. 1) The estimated abundances are resistant to noise since they are based on an initial estimate that has high signal-to-noise ratio (SNR). 2) The variance in the abundance maps is well preserved since the threshold in the dHMRF is derived from the data.
