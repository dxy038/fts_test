Linear coordinated transmit-receive beamforming methods are proposed for spatial underlay direct device-to-device (D2D) communication in cellular networks where both user terminals (UT) and base stations (BS) employ multiple antenna elements. For a D2D terminal pair, direct communication is a beneficial alternative compared to the cellular mode, where the direct data is relayed via BS. The transmitter and receiver design is formulated as a weighted sum-rate (WSR) maximization problem subject to individual transmit power constraints at BSs and users, where the utility is the aggregate sum of end-to-end data rates carried via uplink, downlink, and D2D links. The direct D2D links are allowed to co-exist with the cellular connections. The original problem is reformulated as an equivalent log-MSE minimization problem allowing alternating optimization of the transmit and receive beamformers. The precoder optimization step is efficiently solved using successive convex approximation (SCA) of the non-convex objective and constraints. According to the results, the system performance can be significantly improved with efficient mode selection between the BS and D2D transmission as opposed to solely serving all the users via D2D links or BS. Also, in certain scenarios, it is beneficial to allow a multi-route connection between the UTs.
