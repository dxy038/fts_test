Semi-fragile watermark has attracted attention due to its important role in content authentication for multimedia. In order to distinguish malicious tampering from incidental attacks, semi-fragile watermark must be robust against content-protection image processing. Due to the widely use of JPEG compression, it is always an important subject of semi-fragile watermarking research to improve the performance of anti-JPEG compression under the condition of maintaining high tempering detection abilities. In this paper, after wavelet high frequency coefficients LH<sub>2</sub> and HL<sub>2</sub> are partitioned into coefficient blocks respectively, the energy of each coefficient block is computed. Watermark information is embedded according to the relative coefficient energy relationships. The experimental results show that the proposed algorithm has the advantages such as the objective and subjective image quality assurance, high performance of anti-JPEG compression, larger amount of embedded information, and exact location of malicious attacks.
