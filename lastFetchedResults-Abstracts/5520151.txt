Image denoising is an essential feature of modern Image Signal Processor (ISP). As a part of mobile system, acceptability of denoising methods is determined by electrical power consumption, silicon footprint and architecture of ISP. Non-local means (NLM) denoising algorithm proposed by Buades et al. [1] has very convenient architecture to be implemented either as SoC or CPU/GPU based ISP. Unfortunately, it is prone to produce &#8220;staircasing effect&#8221; [2] on images having nonzero tone gradients. In this paper we propose a simple yet efficient extension of the original NLM algorithm that addresses the staircasing problem. Unlike existing solutions such as [3] or [5] we intentionally avoid kernel regression methods or multiresolution decompositions and focus on improvement of pattern matching process. As a result, our algorithm does not use costly regression computations and provides considerable subjective and objective performance gain (improvement in PSNR ~0.3dB). Also, the ideas explained here can be used in other image processing methods where block matching plays key role.
