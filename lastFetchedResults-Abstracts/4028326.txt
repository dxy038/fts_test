The dynamic nature of the distribution network challenges the stability and control effectiveness of the microgrids in both grid-connected and autonomous modes. In this paper, linear and nonlinear models of microgrids operating in different modes are presented. Optimal design of LC filter, controller parameters, and damping resistance is carried out in case of grid-connected mode. On the other hand, controller parameters and power sharing coefficients are optimized in case of autonomous mode. The control problem has been formulated as an optimization problem where particle swarm optimization is employed to search for optimal settings of the optimized parameters in each mode. In addition, nonlinear time-domain-based as well as eigenvalue-based objective functions are proposed to minimize the error in the measured power and to enhance the damping characteristics, respectively. Finally, the nonlinear time-domain simulation has been carried out to assess the effectiveness of the proposed controllers under different disturbances and loading conditions. The results show satisfactory performance with efficient damping characteristics of the microgrid considered in this study. Additionally, the effectiveness of the proposed approach for optimizing different parameters and its robustness have been confirmed through the eigenvalue analysis and nonlinear time-domain simulations.
