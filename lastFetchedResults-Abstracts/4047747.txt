Robust system control design and seamless transition between various modes of operation are paramount for multifunctional converters in microgrid systems. This paper proposes a control system for single-phase bidirectional PWM converters for residential power level microgrid systems which is robust and can tolerate transitions between the different modes of operation. This is achieved by means of a common inner ac current-loop. Each of the operating modes has an individually designed outer loop performing the corresponding regulation tasks, most commonly including the ac voltage and the dc voltage regulation. A modified , phase-locked loop (PLL) system is used for system-level operation with both small steady-state error and fast response; and a novel islanding detection algorithm based on PLL stability is proposed to facilitate the transition between grid-connected mode and stand-alone mode. Finally, a frequency-response based design procedure for the proposed control system is presented in detail for all operating modes, and its performance is verified experimentally using a DSP-controlled 6 kW 120 V rms (ac)/ 300 V (dc) laboratory converter prototype.
