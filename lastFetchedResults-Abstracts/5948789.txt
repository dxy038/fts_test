Extending previous work using Graphical Processing Units (GPUs) for medical image registration purposes, a medical image registration package has been developed capable of performing 3D non-rigid (free-form) registrations in less than a minute for typical MRI images from OASIS dataset (an average of 15s on a desktop with NVIDIA GeForce GTX 580 graphics card with 512 processing cores and an average of 45s on a laptop with NVIDIA GeForce 445M graphics card with 144 processing cores). Registration is done by minimizing an objective cost function (negative Mutual Information) subject to smoothness constraints. Typically 10<sup>6</sup> - 10<sup>7</sup> parameters are found using one control point per voxel. The program can be used in both diffeomorphic and non-diffeomorphic (faster) modes. The program has been written in C++ and NVIDIA CUDA programming languages performing expensive operations on the GPU. In order to test the validity of the results, the IBSR human brain database was used: pairs of segmented images were registered to each other and a median overlap ratio of segmented ROIs were calculated giving a value of not less than 0.61 in for skull stripped brains. This value has not been exceeded by any of image registration packages tested by Klein et al. 2009 in an equivalent calculation. A fully automatic atlas construction algorithm was built on top of the image registration engine and was tested on both human brains from OASIS and IBSR datasets and murine images obtained from Wolfson Brain Imaging Centre. A graphical user interface was written using Nokia QT framework to make the package easily usable.
