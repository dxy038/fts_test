To meet the increased demand of video-on-demand (VoD) services, peer-to-peer (P2P) mesh-based multiple video approaches have been recently proposed, where each peer is able to find a video segment interested without resort to the video server. However, they have not considered the constraint of the server´s upload bandwidth and the fairness between upload and download amounts at each peer. In this paper, we propose a novel P2P VoD streaming system, named peer cache adaptation (PECAN) where each peer adjusts its cache capacity adaptively to meet the server´s upload bandwidth constraint and achieve the fairness. For doing so, we first propose a new cache replacement algorithm that designs the number of caches for a segment to be proportional to its popularity. Second, we mathematically prove that if the cache capacity of a peer is proportional to its segment request rate, the fairness between upload and download amounts at each peer can be achieved. Third, we propose a method that determines each peer´s cache capacity adaptively according to the constraint of the server´s upload bandwidth. Against the proposed design objective, some selfish peers may not follow our protocol to increase their payoff. To detect such peers, we design a simple distributed reputation and monitoring system. Through simulations, we show that PECAN meets the server upload bandwidth constraint, and achieves the fairness well at each peer. We finally verify that the control overhead in PECAN caused by the search, reputation, and monitoring systems is very small, which is an important factor for real deployment.
