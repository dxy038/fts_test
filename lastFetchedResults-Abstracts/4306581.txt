We propose a precoding strategy which controls amplitude and phase of receiving signals to improve throughput for two-stage bidirectional relaying. We consider the case when the nodes know channel state information (CSI) and can adopt adaptive modulation techniques. We introduce a novel scheme termed adaptive modulation and network coding (AMNC), which jointly optimizes modulations and network coding based on the CSI. For dynamic bit loading and power allocation, we propose a practical time-sharing method called the segmented precoding, in which a packet is split into several sub-packets, and a set of modulation and network coding is optimized in conjunction with amplitude and phase controls for each sub-packet. It is demonstrated that our proposed scheme can offer a significant improvement of achievable throughput for two-way relaying.
