This paper considers the problem of optimizing a thresholddependent flow control strategy by using state information available on-line. It is assumed that a nominal sample realization of a queueing system using this strategy is available, for which the threshold parameter is fixed. In contrast to earlier work, perturbation analysis in this case requires tracking queue lengths in addition to event times, in order to obtain performance sensitivity estimates. The main objective of the paper is to formally derive perturbation equations and describe their algorithmic implementation. These equations are characterized by the requirement for partial state memory in the form of arrival time information. Because the amount of state memory involved grows with the length of the observation interval, a capacity constraint is imposed. The effect of this constraint on our approach is finally investigated and experimental results are included.
