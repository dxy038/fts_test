We present a novel numerical method for nonlinear model-predictive control of heavy-duty trucks. This method realizes a predictive online cruise controller, and includes the opportunity for multiple predictive gear choices. The combination of nonlinear dynamics, constraints, and objective with the hybrid nature of the gear choice makes for a challenging combinatorial prediction problem. The numerical algorithm presented to attack this problem is based on a direct and simultaneous method for the efficient solution of optimal control problems in ordinary differential equations and differential-algebraic equations. Partial outer convexification is applied to treat the mixed-integer aspect of the problem, maintaining certificates of "-optimality. A vanishing constraint formulation for engine speed constraints ensures feasibility of predictive gear choices. Suitable exploitation of direct multiple shooting structures allows to achieve encouraging real-time capable mixed-integer control feedback rates. Numerical results for a heavy-duty truck cruise controller including predictive gear shifts are presented for several artificial and real-world scenarios.
