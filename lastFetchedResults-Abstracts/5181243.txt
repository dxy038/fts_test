We describe a new algorithm for automatic segmenting crystal position map (flood histogram) for PET scintillation detectors. The algorithm naturally reproduces the distortion patterns that are observed in flood histograms generated using Anger logic. It ensures that the correct number of regions is always identified so that irregularities in the flood histogram, such as shifted or merged peaks can be properly handled. Our detector design utilizes two types of photosensors with different dimensions. The mix of these two sizes of photosensors leads to non-uniform and non-symmetric flood histograms. The algorithm determines maps of the signal distribution from each crystal to all of the acquisition channels. The algorithm starts with a standard distribution template. For each flood histogram to be segmented, the same template is first adjusted on a global scale (equivalent to adjusting the gain on each channel), and then on a local scale (accounting for local variations). The boundaries for segmenting individual crystals are estimated by applying Anger logic to values interpolated from the distribution maps. An objective function is defined to quantify the quality of the segmentation, and the distribution maps are modified to minimize the objective function. The same algorithm can be used not only on our detector designs but also can be applied to segmenting all Anger-logic-generated flood histograms.
