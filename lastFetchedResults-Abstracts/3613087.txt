In this paper, the five main formulations of the instantaneous reactive power theory have been chosen to study nonlinear load compensation. They are p-q original theory, d-q transformation, modified or cross-product formulation, p-q-r reference frame, and vectorial theory. The obtention of the compensation current according to each formulation has been established. Next, the behavior of an active power filter (APF) that is implemented with those different control algorithms has been studied. On one hand, a simulation platform with control, APF, and load has been built to test them. Results obtained in an unbalanced and nonsinusoidal three-phase four-wire system have been compared by means of the most adequate indexes. On the other hand, the APF control strategies have been implemented in an experimental platform constituted by a 20-kVA power inverter and a 400-MHz digital signal processing controller board. The final analysis shows that, in general, the five theories present a different behavior, which depends on supply voltage, with respect to distortion. However, all of them widely decrease the waveform distortion. Moreover, a more general compensation objective is possible. It obtains balanced and sinusoidal source current in any conditions of the supply voltage.
