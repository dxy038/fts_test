In this paper, we consider the operation optimization for a microgrid (MG) aggregator, which can procure energy from various sources including the pool market and local distributed energy resources to serve MG customers. We assume that the MG aggregator sells electricity to customers at a predefined retail rate and it also offers customers various contracts for adjusting their loads. Our design objective is to determine the optimal hourly bids that the MG aggregator submits to the day-ahead market to maximize its profit. To deal with various uncertainties, a risk-constrained scenario-based stochastic programming framework is proposed where the MG aggregator´s risk aversion is modeled using conditional value at risk method. The proposed formulation enables customers´ demand response (DR) aggregation to be integrated into the operation of the MG aggregator via contractual agreements. This design is not only beneficial for both MG aggregator and customers, but also facilitates the operation of the system operator (SO), since a single entity (i.e., the MG aggregator) is visible to the SO instead of two separate entities (i.e., a MG aggregator and a DR aggregator). Extensive numerical results are shown to demonstrate the effectiveness of the proposed framework.
